# 도메인 주도 설계 첫걸음

# 1. 비즈니스 도메인 분석하기

> *기업의 비즈니스 도메인과 구조, 즉 핵심 하위 도메인과 지원 하위 도메인, 일반 하위 도메인을 분석하기 위한 도구인 도메인 주도 설계를 배울 것이다.*
> 

## 비즈니스 도메인이란?

비즈니스 도메인은 기업의 주요 활동 영역을 정의한다. 그 예로

- 페덱스는 배송 서비스를 제공
- 스타벅스는 커피로 가장 잘 알려져있음
- 월마트는 가장 널리 알려진 소매업체 중 하나이다.

기업은 여러 비즈니스 도메인을 운영할 수 있으며 언제든 변경이 가능하다는 것에 유의하자.

## 하위 도메인이란?

비즈니스 도메인의 목표를 달성하기 위해 기업은 **여러 가지 하위 도메인**을 운영해야 한다. 하위 도메인은 비즈니스 활동의 세분화된 영역이다. 하위 도메인은 어느 것도 자체적으로 수익을 낼 수는 없지만 회사가 해당 비즈니스 도메인에서 경쟁하려면 여러 하위 도메인들간 상호작용해야 한다.

### 하위 도메인의 유형

- 핵심 하위 도메인
    - 다른 경쟁업체와 다르게 수행하고 있는 차별점
    - 복잡해야 한다
    - 경쟁 우위의 원천이다
- 일반 하위 도메인
    - 모든 회사가 같은 방식으로 수행하는 이미 해결된 비즈니스 활동
    - 회사에 경쟁력을 제공하지 않아 일반적인 솔루션으로 이용 가능
    - 혁신이나 최적화가 필요없음
- 지원 하위 도메인
    - 회사의 비즈니스를 지원하는 활동
    - 일반 하위 도메인과 마찬가지로 어떠한 경쟁 우위도 제공하지 않음
    - 간단히 구현이 가능하다

### 하위 도메인 비교

- 경쟁 우위
    - 핵심 하위 도메인만이 회사에 경쟁 우위를 제공한다. 핵심 하위 도메인은 회사의 핵심 전략이다
- 복잡성
    - 기술적인 관점에서 보면 하위 도메인의 유형에 따라 복잡성의 수준이 다르다. 대체로 핵심 하위 도메인과 일반 하위 도메인이 복잡하며 지원 하위 도메인은 간단하다
    - 하위 도메인의 유형을 면밀히 파악해 핵심 하위 도메인에 최대한 집중해야 한다
- 변동성
    - 핵심 하위 도메인은 자주 변경될 수 있다. 한 번의 시도로 문제가 해결됐다면 그 만큼 복잡성이 떨어져 다른 경쟁자들도 빠르게 따라잡을 수 있다는 뜻이다.
    - 결과적으로 핵심 하위 도메인은 솔루션이 없으며 지속적으로 혁신하고 발전해야 한다.
- 솔루션 전략
    - 핵심 하위 도메인은 사내에서 구현되어야 한다. 핵심 하위 도메인을 솔루션을 구매하거나 외부에서 도입할 수 없다. 만약 가능하다면 경쟁 우위를 점할 수 없다는 뜻이다.
    - 핵심 하위 도메인은 자주 변경될 수 있으므로 회사 내에서 가장 진보된 엔지니어링 기술로 구현해야 하며 유지보수가 가능하고 쉽게 개선될 수 있어야 한다
    - 일반 하위 도메인의 문제는 이미 해결되었기에 검증된 솔루션을 사용하는게 바람직하다
    - 비원 하위  도메인은 경쟁 우위가 없기에 사내에서 구현하지 않는 게 합리적이다. 변경의 빈도가 적고 로직이 단순하기에 하청이나 원칙을 생략하고 간단히 구현하는게 바람직하다

### 하위 도메인 경계 식별

하위 도메인의 경계를 식별해야 솔루션을 구축할 때 설계와 관련된 의사결정에 상당한 도움이 된다. 우선 회사의 부서와 기타 조직 단위는 좋은 출발점이다. 크게 나눈 하위 도메인은 좋은 출발점이지만, 문제는 세부 사항에 있다.

**하위 도메인 정제**

부서를 출발점으로 정했다면 부서의 업무를 조사해 보면 좀 더 세분화되어 있음을 알 수 있다. 우선 세부적인 통찰력을 얻기 위해 세분화해 보자.

→ 하지만 무한정 파헤칠 수는 없다. 언제 멈춰야 할까?

**응집된 유스케이스를 하위 도메인으로**

세분화된 하위 도메인을 찾는 것을 중단하는 시점을 결정하기 위한 지침으로 ‘응집된 유스케이스의 집합인 하위 도메인’ 이라는 정의를 할 수 있다. 이는 하위 도메인의 가장 정확한 경계가 된다.

<aside>
💡 왜 하위 도메인의 경계를 식별하기 위해 온 신경을 곤두세워 노력해야 할까?

</aside>

핵심 하위 도메인은 가장 중요하고, 변동성이 있고, 복잡하다. 따라서 가능한 한 많이 정제하여 일반 및 지원 기능 모두를 추출하고, 핵심 하위 도메인을 발전시키는 데에 더 투자할 수 있게 해준다.

다만, 지원 및 일반 하위 도메인의 경우에는 정제 작업을 다소 완화할 수 있다. 변동성이 낮고 이미 해결된 문제들이기 때문에 검증된 솔루션을 도입하는 방향으로 구현할 수 있다.

**핵심에 집중**

하위 도메인은 소프트웨어 설계 의사결정을 내리는 프로스세의 어려움을 쉽게 해결하기 위한 도구이다. 모든 하위 도메인이 소프트웨어와 관련있을 수는 없으며, 소프트웨어와 관련 없는 하위 도메인을 그 자체로 인정하고 소프트웨어 시스템과 관련된 비즈니스에 집중하라

## 도메인 전문가는 어떤 사람인가?

도메인 전문가는 우리가 모델링하고 코드로 구현할 비즈니스의 모든 복잡성을 알고 있는 주제 전문가이다. 도메인 전문가는 비즈니스 지식의 근원이 되는 비즈니스 문제를 처음으로 파악한 사람들이며, 각 전문가의 전문성 범위는 다양하다. 전체 비즈니스 도메인이 어떻게 작동하는지 상세히 이해하는 전문가가 있는 반면 특정 하위 도메인을 전문으로 하기도 한다

---

# 2. 도메인 지식 찾아내기

> *비즈니스 기능과 로직에 초점을 맞춰 효과적인 커뮤니케이션과 지식 공유를 위한 설계 도구인 유비쿼터스 언어를 배우고, 유비쿼터스 언어를 통해 비즈니스 도메인의 복잡성을 배운다*
> 

## 비즈니스 문제

비즈니스 문제는 비즈니스 도메인과 하위 도메인의 모든 수준에서 발생할 수 있다. 하위 도메인은 세분화된 문제 도메인으로 특정 비즈니스 기능에 대한 솔루션을 제공하는 것이 목적이다.

## 도메인 지식 찾아내기

도메인 전문가가 도메인 지식을 찾아냈다면 도메인 전문가를 이해하고 효과적인 의사소통을 하기 위해서는 그들이 쓰는 동일한 비즈니스 용어를 사용하는 것이 중요하다. 즉, 도메인 전문가가 문제를 생각하는 방식인 **멘탈 모델**을 모방해야 한다.

## 커뮤니케이션

일반적인 소프트웨어 프로젝트에서의 지식 공유 흐름을 살펴보면 도메인 전문가에서 부터 개발자가 작성하는 코드로 변환되면서 여러 가지 형태로 ‘변환’ 된다. 이러한 변환의 과정에 중요한 도메인 지식의 손실이 발생한다. 이러한 손실을 줄이기 위해서 유비쿼터스 언어가 사용된다.

## 유비쿼터스 언어란 무엇인가?

유비쿼터스 언어를 사용하는 것은 도메인 주도 설계의 초석이다. 유비쿼터스라는 단일화된 언어 체계를 세우고 모든 이해 관계자는 비즈니스 도메인을 설명할 때 유비쿼터스 언어를 사용해야 한다.

## 비즈니스 언어

유비쿼터스 언어는 비즈니스 언어다. 모든 이해 관계자가 이해가 가능한 형태의 언어를 사용해야 한다. 개발 적인 너무 전문적인 언어는 사용해서는 안된다.

### 일관성

유비쿼터스 언어는 반드시 정확하고 일관성이 있어야 한다. 모호성을 가져서는 안된다.

**모호한 용어**

어떤 비즈니스 도메인에서 정책이라는 용어가 규제 규칙 또는 보험 계약과 같은 여러 의미를 가질 수 있다. 이러한 모호한 표현을 피해야 하며 각각 규제 규칙, 보험 계약의 두 용어를 사용해 명확한 모델을 만들어야 한다.

**동의어**

유비쿼터스 언어에서 두 용어는 서로 바꿔 사용할 수 없다. ‘사용자’, ‘관리자’, ‘계정’ 등의 용어가 서로 혼용될 수 있는데 이러한 동의어의 사용한 피해야 하며 각각의 용어는 분명 서로 다른 의미를 갖을 수 있기에 모든 이해관계자는 용어의 차이점을 이해해야 한다.

## 비즈니스 도메인 모델

모델은 실세계의 복제가 아니라 우리가 실제 시스템을 이해하는 데 도움을 주는 인간의 창조물이다. 예로 지도가 있다.

### 효과적인 모델링

모든 모델에는 목적이 있고 효과적인 모델은 그 목적을 달성하는 데 필요한 세부사항만 포함한다. 모델은 본질적으로 **추상화의 결과**이며 추상화 개념은 불필요한 상세 정보를 생략하여 당면한 문제를 푸는 데 필요한 정보만 남게 한다.

### 비즈니스 도메인 모델링

유비쿼터스 언어는 도메인의 모든 가능한 상세 정보를 포함하는 것이 아니다. 소프트웨어가 해결하고자 하는 특정 문제를 해결하는 데 필요한 만큼의 비즈니스 도메인 관점을 포함하면 된다.

### 지속적인 노력

유비쿼터스 언어를 정형화 하려면 지속적으로 도메인 전문가와 상호작용이 필요하다. 유비쿼터스 언어를 사용해 도메인 전문가와 의사소통하여 비즈니스 도메인에 대한 공유된 이해를 강화해야 한다.

### 도구

위키는 유비쿼터스 언어를 수집하고 관리하는 용어집으로 사용될 수 있다. 하지만 용어집은 명사에만 효과적이기에 행동을 포착하기 위해 거킨 테스트를 함께 사용하는 것이 가장 좋다. 더불어, 유비쿼터스 언어의 용어의 사용을 검증할 수 있는 정적 코드 분석 도구인 NDepend도 있다. 이러한 도구가 유용하기 하지만 가장 중요한 것은 실제로 언어를 사용해 대화하는것이 가장 좋다. 

> “프로세스나 도구보다 개인과 상호작용이 우선이다” - 애자일 매니페스토
