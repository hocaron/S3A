# 1. 주키퍼 구성

주키퍼는 파티션, 브로커의 메타데이터를 저장하고 컨트롤러 서버를 선출한다.

최근부터는 카프카 내부에서 해당 역할을 수행할 수 있게 되어 운영 효율성을 높였다.

---

## 1.1 주키퍼 서버 수량

주키퍼는 쿼럼 구성을 기반으로 동작하여 홀수로 구성하는 것이 바람직하다. 최소 노드 수는 3이 권장된다.

3대로 구성하게 되면 과반수인 2를 충족할 수 있는 최대 1대의 서버 장애를 허용할 수 있다.

주키퍼를 5대로 구성한다면 2대의 서버 장애를 허용할 수 있다.

운영 환경의 카프카의 사용량이 높지 않고 카프카 클러스터의 중요도가 크게 높지 않다면 3대로 구성하는 것이 적합하다.

하지만 회사의 핵심 중앙 데이터 파이프라인으로써 주키퍼를 사용하거나, 카프카의 사용량이 낮지만 회사에서 매우 중요한 역할로 쓰인다면 5대로 구성하는 것이 좋다.

---

## 1.2 주키퍼 스펙

- 메모리 크기 : 4GB ~ 8GB
- 디스크 : 240GB ~ 480GB SSD
- Heap : 1GB ~ 2GB

이 권장된다. 주키퍼에 과하게 스펙을 투자할 필요는 없으며 트랜잭션, 스냅샷 로그를 디스크에 저장하는 경우가 잦은데 이를 위해 쓰기 성능이 좋은 SSD가 권장된다.

또한 주키퍼와 카프카에는 메타데이터 같이 작은 데이터를 주고 받기 때문에 네트워크 카드에 대한 스펙도 1G 이더넷 카드정도로 해도 충분하다.

---

## 1.3 주키퍼 분산 배치

주키퍼를 하나의 물리적 랙에 배치하는 것은 권장되지 않는다. 클라우드, 온프레미스 일 경우 주키퍼를 분산하여 배치하는 것이 적절한데

클라우드 환경에서 사용할 때는 가용 영역을 2~3개로 다르게 배치하여 운영하는 것이 안정성을 확보하기에 적합하다.

---

# 1.4 카프카 구성

