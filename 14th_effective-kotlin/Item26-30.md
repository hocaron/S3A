# Item [26 ~ 30]

일자: 2024년 5월 21일
참석자: 박범근, 예원 오, 김보배, 한정민

TMI: 회식 데이



## Item 26. 함수 내부의 추상화 레벨을 통일하라

160p) 함수도 높은 레벨과 낮은 레벨을 구분해서 사용해야 한다는 원칙이 있습니다. 이를 추상화 레벨 통일(Single Level of Abstractio, SLA) 원칙 이라고 부릅니다.

- 보배) 오로지 하나의 함수로 크게 구성하는 것이 아닌 높은 추상화 레벨의 함수와 목적이 확고한 낮은 레벨의 함수를 이용해 더 가시성을 높일 수 있다. 근데 이게 왜 “추상화 레벨 통일”이지? 그냥 “추상화 레벨 분리”이런 이름이여야 하는거 아닌가...
- 정민) **함수 내의 로직은 (하나의 함수 안에서는) 추상화 레벨이 모두 같아야 한다.** 라는 의미의 원칙인 것 같네요
- 범근) 함수끼리의 복잡성을 통일시켜라? 높은 레벨 낮은 레벨 나눠서

161p) 함수는 간단해야 합니다. 이는 ‘함수는 작아야 하며, 최소한의 책임만을 가져야 한다’라는 일반적인 규칙입니다.

- 보배) 한번 크게 작성된/긴 함수들은 쪼개기도 힘들다 (테스트 없으면 더 지옥). 첫 설계부터 고민을 많이하는 것도 좋을 것 같음 ㅠ
- 정민) 함수가 크다는 건, 절차지향적 코드 + 빈약한 도메인모델로 인한 결과일지도..? 라는 말을 배우고 잘 고쳐나가고 있습니다..
- 범근) 요즘 개발하면서 함수, 클래스 책임 분리하면서 다 찢는중… 확실히 테스트짤때 편한듯합니다.

163p) 입출력은 낮은 레벨의 모듈, 비즈니스 로직을 나타내는 부분이 높은 레벨의 모듈입니다.

- 범근) 이 레벨이라는게 변경에 더 노출된 관점인건가? 입출력은 변경이 잦고 변경에 직접적이지만, 비즈니스 로직은 그나마 견고하니까? (변경사항은 있지만 입출력에 비해서) 보통 높은레벨은 추상화, 낮은 레벨은 구체화된 구현 클래스를 이야기했어서 한번에 와닿지않네

163p) 계층화가 잘 된 프로젝트는 어떤 계층 위치에서 코드를 보아도, 일관적인 관점을 얻을 수 있습니다.

- 보배) 일관적인 관점이라는게 무엇일까? 쉽게 풀어 설명하면?
- 정민) 어느 계층에서는 어느 일만 하고 어떠한 역할만 하는구나 / 저 밑에 계층 코드는 이러한 계층이니까 이러한 동작들을 수행하는 구나가 예상이되고 또 그 예상과 맞게 코드가 짜여져있는 결과를 얻을 수 있는.. 그러한 관점

## Item 27. 변화로부터 코드를 보호하려면 추상화를 사용하라

164p) **물 위를 걷는 것과 명세서로 소프트웨어를 개발하는 것은 수비다. 둘 다 동결되어 있다면…**

- 정민) ㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋ

172p) 인터페이스 페이킹 

- 정민) 테스트 용 인터페이스 구현체를 만드는건가..?
- 범근) 그르게. 근데 그냥 val messageDisplay: MessageDIsplay = mock() 쓰면 안되나 ㅎ

173p) 만약 그 시점 이전에 ID가 계속 Int로 유지될 거라고 생각해서, 여러 연산들이 타입에 종속적이게 작성되었다면 어떻게 해야 할까요? 이를 최대한 방지하려면, 이후에 ID 타입을 쉽게 변경할 수 있게 클래스를 사용하는 것이 좋습니다.

- 보배) 예전에 교육들을 시절 객체지향 생활체조 원칙이란 것에서 해당 내용을 배웠던게 기억남. 근데 사실 하나의 프로퍼티를 가진 클래스를 만드는게 번거로운 느낌이라… 쉽지는 않은 것 같음.
    - [https://hudi.blog/thoughtworks-anthology-object-calisthenics/#원칙3-모든-원시값과-문자열을-포장한다](https://hudi.blog/thoughtworks-anthology-object-calisthenics/#%EC%9B%90%EC%B9%993-%EB%AA%A8%EB%93%A0-%EC%9B%90%EC%8B%9C%EA%B0%92%EA%B3%BC-%EB%AC%B8%EC%9E%90%EC%97%B4%EC%9D%84-%ED%8F%AC%EC%9E%A5%ED%95%9C%EB%8B%A4)
- 범근) 약간 VO같이 쓰라는건가 class Money (val amount: BigDecimal) 이런거처럼

175p) FizzBuzz

- [https://github.com/EnterpriseQualityCoding/FizzBuzzEnterpriseEdition](https://github.com/EnterpriseQualityCoding/FizzBuzzEnterpriseEdition)
- 범근) ㅋㅋㅋㅋ 뭐든지 적당히;;

176p) 추상화를 이해하려면, 예제를 살펴보는 것이 좋습니다. 요소를 사용하는 방법을 보여 주는 단위 테스트와 문서의 예제는 추상화가 어떻게 사용되는지 확실하게 보여줍니다.

- 보배) 추상화가 되었다면, 이해를 돕기 위해 테스트 코드를 읽기 좋게/이해하기 좋게 잘 구성해놓을 것.
- 정민) 적당한 추상화..
- 범근) 추상화 너무 되어있으면 못읽겠음… 외계어같아
    - 정민) ㅈㅅ .. 저는 요새 추상화 뽕에 취해서 추상화 처리하고 PR 에 for 이후 유연성과 확장성 이러고 ㅋㅋㅋㅋㅋ

## Item 28. API 안정성을 확인하라

178p) 라이브러리가 변경되어도 이전 라이브러리를 유지하는 경우

- 범근) 버전 동시에 관리하다가, 강제 업데이트…

179p) 시멘틱 버저닝 사용 

- 정민) 여러분들은 팀에서 어떤 버저닝 정책을 사용하나요
- 범근) 라이브러리는 만든적이 없어서 마이너 패치 버전은 사용 안해봤는데, API는 그냥 v1 → v2 → xxx로 쿨하게 갑니다.

180p) IDE가 자동 전환을 할 수 있게 `ReplaceWith` 를 붙여 주는 것도 좋습니다.

- 보배) 아니 이런게 있었어? Java에도 있겠지?!?!?! ⇒ 없음… `Deprecated` annotation kotlin class 임…
- 범근) ReplaceWIth 신기하네 별게 다있다.

181p) 이렇게 `Deprecated`, `ReplaceWith` 를 사용했다면, 사용자가 이러한 변경에 적응할 시간을 제공해야 합니다.

- 보배) [kotlin enum/entries](https://binux.tistory.com/171) 정리할 때 봤던건데, IDE 도움을 받아서 부드럽게 폐기(will be softly decommissioned)한다고 했음.
    - IDE에서 deprecated 된 코드의 추천 우선순위를 낮추고, 자동완성에서 제거. 사용했다면 대체 코드를 사용하도록 Soft warning 추가. 같은 작업들을 하게 해서 점진적으로 대체되도록 지원함.
    - 정민) 덕분에 잘봤었습니다. ^^
    - 범근) 파워블로거 킹보배

## Item 29. 외부 API를 랩(wrap)해서 사용하라

에?

에에?

## Item 30. 요소의 가시성을 최소화하라

184p) 변경을 가할 때는 기존의 것을 숨기는 것보다 새로운 것을 노출하는 것이 쉽습니다.

- 보배) 공감. 앱 서비스를 지원할 때, 구앱대응 때문에 기존의 것을 숨기는 것조차 불가능할 때가 많음. 더욱이 문제는 그걸 언제 지우느냐/누가 지우느냐는 결정되지 않는다는 것.
- 정민) 앱 구버전 호환을 위해 access_log 다 뒤져서 해당 API 호출 있는가 확인하고, Client 분들한테 해당 필드 쓰나요 다 멘션 걸어서 물어보고 안쓴다…? → 해당 필드 혹은 API 제거..
- 범근) 우리랑 똑같다 ㅋㅋ 해당 API 호출되는지 로그 다 보고, 최종적으로 언제 없앤다고 공지 때리고 관련부서 호출하고

185p) private set

- 범근) 불변성을 지키기 위해 실제로 사용해봤음. 외부에서 변경 못하게..

186p) 코틀린의 접근 제한자

- 보배) Java 사용하다보면 Kotlin 접근제한자는 맨날 헷갈림.
    - `default` 접근제한자가 코틀린에는 없다. 즉, 패키지 별 제한은 둘 수 없다.
    - 코틀린의 기본 접근제한자는 public이다.

187p) **코틀린에서 모듈이란 함께 컴파일되는 코틀린 소오스를 의미**

- 범근) 초반에 코틀린 internal 같은거 책으로만 읽어서 이해 잘 안됐는데, 멀티모듈 프로젝트하면서 internal로 다른 모듈에서 사용 못하게 막으니까 메서드 사용을 코드레벨에서 강제로 막을 수 있어서 좋았슴
- 보배) 모듈 단에서 의존성 다음 단계로 커버칠 수 있겠군 (의존을 가져도 호출못하게 `module-info` export 안하는 느낌)

187p) 데이터를 저장하도록 설계된 DTO 에는 적용하지 않는 것이 좋다. 

- 정민) 보통 DTO 는 어떻게 정의하시나요? data class or class /  Java → Record or Class ?

- 범근) 전 코틀린에선 걍 data class 넣고 시작했던거같아요.