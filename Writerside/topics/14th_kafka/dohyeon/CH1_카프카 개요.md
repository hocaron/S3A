# 0. 요약

- 카프카가 제공하는 주요 장점
  - 높은 처리량
  - 순서 보장
  - 적어도 한 번 전송
  - Pulling 방식
  - 파티셔닝
  - 높은 확장성
  - 고가용성
  - 내구성

---

# 1. Zalando, Twitter 카프카 사용 사례

## 이 기업들은 왜 카프카를 선택했을까?

### 1. 빠른 데이터 수집이 가능한 높은 처리량

HTTP기반으로 이벤트를 처리함에도 `한 자리수의 ms단위`로 처리되어 빠르고 안전한 데이터 전송을 할 수 있다.

### 2. 순서 보장

이벤트 처리 순서를 보장 할 수 있다.

### 3. 적어도 한 번 전송 방식

프로듀서가 재전송을 하더라도 데이터 변화는 일어나지 않는다. 이로인해 이벤트들이 중복될 순 있지만 누락 없는 재전송이 가능해 메세지 손실 걱정이 사라진다.

### 4. 백프레셔 핸들링

카프카 클라이언트는 Pull 방식으로 동작한다. 

- Pull 방식은 클라이언트의 속도대로 데이터를 처리할 수 있는 장점이 있다.
- Push방식은 브로커가 보내주는 속도에 의존해야한다.

### 5. 파티셔닝

카프카의 파티셔닝 기능은 논리적으로 토픽을 여러 개로 나눌 수 있다.

각 파티션들을 다른 파티션과 독릭접으로 처리/운영 할 수 있어 수평적인 확장이 가능하다.

---

# 2. 카프카의 주요 특징

## 2.1. 높은 처리량과 낮은 지연시간

Pulsar vs RabbitMQ vs Kafka 를 비교해봤을 때 처리량과 지연시간은 아래와 같다.

### 처리량 

- 605 MB/s [Kafka]
- 305 MB/s [Pulsar]
- 38 MB/s [RabbitMQ]

### 지연시간

- 5 ms [Kafka, 200 MB 로드 시]
- 25ms [Pulsar, 200 MB 로드 시]
- 1ms [RabbitMQ, 30 MB 로드 시 (30MB가 넘아가는 시점에선 지연시간이 크게 증가한다.)]

## 2.2. 높은 확장성

파티셔닝을 통해 높은 확장성을 얻을 수 있다.

## 2.3. 고가용성

카프카의 내부 동작 원리에 의해 고가용성을 확보할 수 있다.

## 2.3. 내구성

프로듀서의 `acks`옵션으로 메세지의 내구성을 강화할 수 있다.

카프카의 로컬 저장소에 영구적으로 메세지를 저장할 수 있는 옵션이 있고, 컨슈머가 메세지를 가져가더라도 메세지는 일시적으로 삭제되지 않는다.

또한 메세지들은 브로커 한 대에만 저장되는 것이 아니라 여러대의 브로커에 저장되므로 브로커 중 한대가 불용상태가되어도 복구할 수 있다.

## 2.4. 개발 편의성

프로듀서 컨슈머가 독립적으로 개발 할 수 있으며 카프카 커넥트, 스키마 레지스트리를 통해 개발 편의성을 증대시킬 수 있다.

## 2.5. 운영 및 관리 편의성

그라파나와 함께 운영 모니터링을 적용할 수 있다.
