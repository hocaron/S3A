## 03. 도메인 복잡성 관리
언어는 비즈니스 도메인의 내부 동작과 기본 원칙에 대한 도메인 전문가의 멘탈 모델을 반영해야 한다.
- 소스코드는 모호성에 잘 대처하지 못한다.
- 무엇을 하든지 항상 복잡성에 직면하게 된다.

### 바운디드 컨텍스트란 무엇인가?
- 유비쿼터스 언어를 작은 언어 영역으로 나누고, 각 언어를 적용할 수 있는 명시적인 bounded context.
- 바운디드 컨텍스트는 유비쿼터스 언어의 일관성이 유지되는 경계다.
- 유비쿼터스 언어는 바운디드 컨텍스트에 포함된 모델을 설명하는 데만 집중한다.
- 모델의 크기에 정답은 없지만, 모델 자체로 유용해야 한다.
- 바운디드 컨텍스트의 크기에 대한 결정은 문제 도메인이 무엇이냐에 따라 달라진다.
- 같은 데이터에서 작동하는 응집된 유스케이스의 집합을 식별하되, 그것을 여러개의 바운디드 컨텍스트로 분해하지 말라.

### 바운디드 컨텍스트 vs 하위 도메인
비즈니스 도메인은 여러 하위 도메인으로 구성된다.
비즈니스 도메인을 세분화된 문제 도메인 or 바운디드 컨텍스트의 집합으로 분해한다.
위의 두 방법(경계)가 필요한 이유는?

- 하위 도메인은 상호 관련된 유스케이스 집합과 유사하다.
    - 소프트웨어 엔지니어는 하위 도메인을 식별하기 위해 비즈니스 도메인을 분석한다.
- 반면에 바운디드 컨텍스트는 소프트웨어 엔지니어에 의해 설계된다.
- 중요한 것은 하위 도메인은 발견하고 바운디드 컨텍스트는 설계한다는 점이다.
- 바운디드 컨텍스트 패턴은 물리적 경계과 소유권 경계를 규정하기 위한 도메인 주도 설계 도구다.

### 실생활의 바운디드 컨텍스트
- 바운디드 컨텍스트는 시맨틱 도메인의 사전적 개념에 기반한다고 볼 수 있다.
    - 의미 영역과 단위 영역으로 구분한다. 
- 모델은 실제 엔티티를 복사해서는 안된다. 대신 목적 즉, 해결해야 할 문제가 있어야한다.
    - "이 모델은 어떤 문제를 해결하고자 하는가?" 이다.
- 모델은 당면한 작업과 관련 없는 정보는 생략해야 한다.
- - -
## 04. 바운디드 컨텍스트 연동
모델의 목적, 즉 경계를 명시하지 않고는 모델을 구축할 수 없다.
하나의 바운디드 컨텍스트 내의 언어는 특정 문제를 해결하는 비즈니스 도메인을 모델링한다.
바운디드 컨텍스트는 서로 독립적으로 발전할 수 있지만 상호작용해야하고, 이 영역을 "컨트랙트"라고 부른다.
바운디드 컨텍스트를 작업하는 팀 간 협력적 특성은 "협력", "사용자-제공자", "분리형 노선"으로 그룹 지을 수 있다.

### 협력형 패턴 그룹
팀 간의 협력에 적합한 두가지 패턴인 파트너십 패턴과 공유 커널 패턴
- 파트너십 패턴
    - ad-hoc 방식
    - 연동의 조정은 양방향
- 공유 커널 패턴
    - 공유 커널과 같은 공유 모델은 모든 바운디드 컨텍스트의 필요에 따라 설계된다.
    - 공유 커널은 바운디드 컨텍스트 간에 제공될 의도가 있는 연동 관련 컨트랙트와 자료구조만으로 구성하는 것이 이상적.
    - 공유 커널은 여러 바운디드 컨텍스트에 속하기 때문에 변경은 지속적으로 통합 되어야함.
    - 공유 커널을 사용하기 위해선 중복 비용과 조율 비용의 비율을 따지고, 중복 비용 > 조율 비용일 때에 사용한다.
        - 통합 비용과 중복 비용의 차이는 모델의 변동성에 달렸다. 변경이 잦을수록 통합 비용은 높아진다.
    - 바운디드 컨텍스트의 연동 컨트랙트를 명시적으로 정의하는 데 공유 커널을 사용할 수 있다.

### 사용자 - 제공자 패턴 그룹
대부분의 경우 업스트림(제공) 또는 다운스트림(사용)의 팀이 연동 컨트랙트를 주도하는 권력의 불균형이 존재한다.
힘의 차이를 나타내는 "순응주의자", "충돌 방지 계층", "오픈 호스트 서비스" 패턴
- 순응주의자(conformist) 패턴
    - 다운스트림 팀이 업스트림 팀의 모델을 받아들이는 바운디드 컨텍스트의 관계
- 충돌 방지 계층(anticorruption layer, ACL) 패턴
    - 충돌 방지 계층을 통해 업스트림 바운디드 컨텍스트의 모델을 스스로의 필요에 맞게 가공
    - 제공자의 모델을 따르는 것을 원치 않거나 순응에 필요한 노력이 가치가 없을 경우를 다룸
- 오픈 호스트 서비스(open-host service, OHS) 패턴
    - 힘이 다운스트림(사용자)쪽에 있을 경우
    - 외부에 제공되는 퍼블릭 모델과 그 내부 구현을 다 속도로 발전시킬 수 있다.
    - 업스트림(제공자)의 퍼블릭 인터페이스는 자신의 유비쿼터스 언어를 따르는 대신 연동 지향 언어를 통해 사용자에게 더 편리한 프로토콜을 노출한다.
    - OHS는 ACL과 반대되는 패턴이다.

### 분리형 노선(separated ways)
전혀 협력하지않는 것 -> 분리형 노선 패턴
- 기능 중복이 협업보다 비용이 저렴한 경우.

## 컨텍스트 맵
시스템의 바운디드 컨텍스트 간의 연동 패턴을 분석하면 컨텍스트 맵으로 그릴 수 있다.
- 컨텍스트 맵은 프로젝트 초기부터 도입해서 새로운 바운디드 컨텍스트와 기존 요소에 대한 수정을 반영하는 것이 이상적이다.(이거를 어케하누)

- - - 
# 오늘의 결론
- 바운디드 컨텍스트는 서로 독립적이지 않다. 서로 상호작용해야한다.
- 다음 장부터는 전략적 관점 -> 전술적 관점으로 넘어간다!